{"version":3,"file":"static/js/503.10e2fe94.chunk.js","mappings":"mKAIA,MAkEA,EAlEaA,IACX,MAAM,KAAEC,EAAI,YAAEC,GAAgBF,GACxB,MAAEG,EAAK,OAAEC,GAAWJ,EAEpBK,GAAeC,EAAAA,EAAAA,UA2DrB,OAzDAC,EAAAA,EAAAA,WAAU,KACR,MAAMC,GAAeC,EAAAA,EAAAA,GAAOR,GAEtBS,EAAOC,EAAAA,GAAU,CACrBR,MAAOA,EACPC,OAAQA,EACRQ,UAAW,GACXC,WAAY,CAAEC,KAAM,WAAYC,OAAQP,GACxCQ,MAAO,CACLC,QAAQ,EACRC,MAAO,CAAC,QAAS,WACjBC,MAAO,mFACPC,WAAaC,IAAMC,EAAAA,EAAAA,IAAeD,GAAGE,eAAe,UAEtDC,MAAO,CACLb,EAAAA,GAASH,EAAc,CACrBiB,KAAOJ,IACL,MAAMK,EAAIxB,EAAYyB,KACnBC,GAASA,EAAKC,gBAAkBR,EAAES,WAAWD,cAEhD,OAAOH,GAAKA,EAAEK,KAAO,GAEvBC,OAAQ,QACRC,YAAa,GACbC,KAAM,CAAEC,QAAS,WAEnBxB,EAAAA,GACEH,EACAG,EAAAA,GAAc,CACZyB,KAAOf,IACL,MAAMgB,EAAYnC,EAAYyB,KAC3BC,GAASA,EAAKC,gBAAkBR,EAAES,WAAWD,cAEhD,OAAOQ,EAAYA,EAAUC,eAAiB,IAEhDb,KAAM,QACNO,OAAQ,QACRO,WAAY,QACZC,GAAI,KAGR7B,EAAAA,GAAU,CAACT,EAAY,GAAGuC,aAAc,CACtCC,YAAa,MACbC,IAAK,GACLC,SAAU,GACVR,KAAOf,GAAMA,KAGjBwB,MAAO,CACLC,SAAU,aAKd,OADAzC,EAAa0C,QAAQC,OAAOtC,GACrB,IAAMA,EAAKuC,UACjB,KAEIC,EAAAA,EAAAA,KAAA,OAAKC,IAAK9C,I","sources":["components/map.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\nimport * as Plot from \"@observablehq/plot\";\nimport { rewind, compactNumber } from \"../utils\";\n\nconst Map = (props) => {\n  const { data, highlighted } = props;\n  const { width, height } = props;\n\n  const containerRef = useRef();\n\n  useEffect(() => {\n    const dataRewinded = rewind(data);\n\n    const plot = Plot.plot({\n      width: width,\n      height: height,\n      marginTop: 32,\n      projection: { type: \"mercator\", domain: dataRewinded },\n      color: {\n        legend: true,\n        range: [\"white\", \"#ee4444\"],\n        label: \"Δ расходов 2023 — 2024, ₽\",\n        tickFormat: (d) => compactNumber(-d).toLocaleString(\"ru-RU\"),\n      },\n      marks: [\n        Plot.geo(dataRewinded, {\n          fill: (d) => {\n            const e = highlighted.find(\n              (elem) => elem.territory_id === +d.properties.territory_id\n            );\n            return e ? -e.diff : 0;\n          },\n          stroke: \"black\",\n          strokeWidth: 0.5,\n          sort: { channel: \"-fill\" },\n        }),\n        Plot.text(\n          dataRewinded,\n          Plot.centroid({\n            text: (d) => {\n              const territory = highlighted.find(\n                (elem) => elem.territory_id === +d.properties.territory_id\n              );\n              return territory ? territory.territory_name : \"\";\n            },\n            fill: \"black\",\n            stroke: \"white\",\n            textAnchor: \"start\",\n            dx: 6,\n          })\n        ),\n        Plot.text([highlighted[0].region_name], {\n          frameAnchor: \"top\",\n          dy: -24,\n          fontSize: 16,\n          text: (d) => d,\n        }),\n      ],\n      style: {\n        overflow: \"visible\",\n      },\n    });\n\n    containerRef.current.append(plot);\n    return () => plot.remove();\n  }, []);\n\n  return <div ref={containerRef} />;\n};\n\nexport default Map;\n"],"names":["props","data","highlighted","width","height","containerRef","useRef","useEffect","dataRewinded","rewind","plot","Plot","marginTop","projection","type","domain","color","legend","range","label","tickFormat","d","compactNumber","toLocaleString","marks","fill","e","find","elem","territory_id","properties","diff","stroke","strokeWidth","sort","channel","text","territory","territory_name","textAnchor","dx","region_name","frameAnchor","dy","fontSize","style","overflow","current","append","remove","_jsx","ref"],"sourceRoot":""}